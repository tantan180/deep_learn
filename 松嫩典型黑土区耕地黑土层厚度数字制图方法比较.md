# 松嫩典型黑土区耕地黑土层厚度数字制图方法比较

## 摘要

黑土层与农田土壤肥力有关，准确刻画黑土层厚度的空间分布对》》》》具有重要意义。

* 地区：东北松嫩典型黑土区

* 基础数据：106个剖面点&45个环境因子

* 机器学习算法预测：多元线性回归（MLR）、**随机森林（RF）**、梯度提升树（GBDT）、极端梯度提升（XGBoost）、**随机森林回归克里格（RF-RK）**、**堆叠泛化模型（Stacking）**

* 结论：1. Stacking表现最佳，其次RF-RK和RF

     2. 剔除贡献度低的环境变量后，不同模型的
        $$
        R^2
        $$
        

​	平均提升0.11，其中MLR多元线性回归提升最大为0.32；

3. 不同模型预测的结果基本一致，60cm以上在东北部和东南部，30cm以下在西南部，，
4. 总初级生产力（GPP）、坡度坡长因子（LS）和地表温度最大值合成（LSTm）是模型中最重要的解释变量

## 引言

黑土层变薄问题不容忽视。目前缺乏东北黑土层厚度空间分布数据。根据典型土壤剖面进行实地调查耗费人力物力，而数字土壤制图（Digital Soil Mapping, DSM）具有高效性、成本低、应用广泛等特点。

目前常用的DSM方法有：*地统计法*、**机器学习**和混合模型。

1. 普通克里格（Ordinary Kriging，OK）是*地统计法*中最具有代表性的

2. 相比地统计法，**机器学习**能提取土壤与环境之间的关系，对预测土壤属性的空间分异特征效果更佳

* 较简单的一种机器学习方法是**多元线性回归**（Multiple Linear Regression，MLR），它主要基于土壤属性与环境变量之间的线性关系进行预测制图
* 然而，土壤属性与环境变量之间*多呈复杂的非线性关系*，集成机器学习模型如**随机森林**（Random Forest，RF）、**梯度提升树**（Gradient Boost-ing Decsion Tree，GBDT）、**极端梯度提升**（ExtremeGradient Boosting，XGBoost）能较好地对这种复杂的非线性关系进行捕捉和建模
* 然而，对土壤厚度进行预测相比对土壤有机碳、土壤pH等预测具有更大的难度

3. 混合模型是一种结合了多种模型的方法，可充分利用它们的优势

​	**随机森林回归克里格**（Random Forest- Regression Kriging，RF-RK）和**堆叠泛化模型**（Stacking）相对较新且有效。

综上，由于各种预测模型具有其独特特点，针对不同的研究区和土壤属性对象，模型性能会呈现出明显差异，因此适用于不同的土壤属性预测制图问题。且目前缺乏关于黑土层厚度数字制图的相关研究，所以比较不同方法对黑土层厚度的预测制图效果，选取出最优数字制图模型至关重要。

# 研究区概况与数据来源

## 研究区概况

黑龙江省与吉林省，8个重要农业区之一，地形是平原和漫岗。海拔、气温、降水，土壤类型，黑土地包括**黑土、黑钙土**、草甸土、白浆土、暗棕壤等。**黑土、黑钙土**2种土壤类型有机质含量丰富，黑土层较厚

## 黑土层数据及处理

取东北地区土系志106个剖面点作为建模预测的基础数据，剖面点采样于2010—2012年。具有完整的土壤分层符号、土壤颜色和有机碳含量信息，将符合以下要求的土层判定为黑土层：①土壤分层符号介于A层、AB层和B层范围内；②土壤润态的明度和彩度≤3；③土壤有机碳含量≥6 g/kg。

## 环境变量及处理

DSM的关键是预测模型的构建，需选取更多能影响土壤信息分布的辅助环境变量

基于SCORPAN土壤景观模型：地形因子、气候因子、遥感因子、土壤因子及其他变量。

本研究共收集环境协变量**45个**，将其空间分辨率用双线性插值法重采样为90 m，并统一投影坐标系统和空间范围。地形因子中的DEM来源于**国家地球系统科学数据中心**（http://northeast.geodata.cn/），地形衍生因子利用ArcMap 10.8和SAGA 8.4.1软件计算获取。
共获取**12个**地形因子。

气候因子来源于**地球大数据科学工程数据共享服务系统**（https://data.casearth.cn/），时间范围是2010—2012年，利用ArcMap 10.8进行数据预处理。共获取**4个**气候因子。

遥感因子均通过**谷歌地球引擎**（Google EarthEngine，GEE）平台获取，在ArcMap 10.8中进行数据预处理。其中仅NIR通过Landset7影像获取，GPP、NDVI、EVI、LST、LSTm、FPAR、FPARm、LAI、LAIm均通过MODIS影像获取，时间范围是2010—2012年每年的4—11月。基于GEE平台对MODIS卫星数据按月均合成4—11月影像，共获取8期EVI时间序列影像，再通过R4.1.1软件提取EVI时间序列特征数据，共提取9个特征。共获取**19个**遥感因子。

土壤因子中的Sand和Silt来源于**中国科学院资源环境科学数据中心**（https://www.resdc.cn/）的中国土壤质地空间分布数据，数据初始分辨率是1 km。另外，Soiltype、Landcover均来自**国家地球系统科学数据中心**（http://northeast.geodata.cn/），Soiltype主要分为黑土、黑钙土、草甸土、暗棕壤和其他5个类型。共获取**6个**土壤因子。

其他变量中的LC、OLC45在Python 3.10环境下计算获取，DtRiver和DtRoad通过ArcMap 10.8工具箱的欧氏距离计算获取，其中DtRiver的源图层是中国四级及以上河流图层，DtRoad 的源数据是OpenstreetMap中获取的道路图层。共获取**4个**其他变量。

![image-20241221215142194](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241221215142194.png)

## 环境变量优选

1. 因子重要性排序：基于RF模型对所有环境变量进行因子重要性排序后，通过逐一添加正向排序后的变量进行建模并计算每次的R2来确定最佳特征集，实现对环境变量的初次筛选。

2. 相关性剔除法：计算初次筛选后的不同环境变量间以及环境变量与目标变量黑土层厚度之间的相关性，筛除掉相关性高的环境变量，去除冗余信息，最终得到一组环境变量。具有高相关性的环境变量很可能会对建模结果造成过拟合和降低解释性的影响。

## 模型方法

​	所有模型均在**Python 3.10**环境下实现，以上模型通过 **sklearn、xgboost 和 pykrige 库**中的方法实现。其中 MLR 使用默认参数，RF、GBDT、XG-Boost、RF-RK和Stacking模型均使用**网格搜索交叉验证**（GridSearchCV）进行模型关键参数优化，得到较优参数。





## 最后确定的因子

​	通过随机森林内置的因子重要性排序法，逐一正向添加，然后根据R2值进行剔除。再根据相关性剔除法，基于相关性热图，去除相关性较高（R>0.9）的因子，最后得到14个因子。

![因子相关性热力图](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241221182206223.png)

## 不同模型性能比较

前：最好的是RF-RK，最差的是MLR，Stacking和RF也比较好

后：最好的是Stacking，最差的是MLR，RF-RK和RF也比较好

![image-20241221211405028](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241221211405028.png)

​	基于RF进行不确定性预测，不确定性低的区域主要在西南部和中部，这里黑土厚度较薄，其不确定性相对较低。不确定性变化大部分区域都降低了，升高区域主要在中部。

![image-20241221211833850](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241221211833850.png)

## 最优协变量

​	使用RF对黑土层厚度进行建模预测时具有较高影响力的前5个环境变量分别是**GPP、LS、LSTm、LAIm和DEM**，其中GPP、LSTm和LAIm是遥感变量，LS和DEM是地形变量，说明这5个环境变量是影响松嫩典型黑土区黑土层厚度预测的主要变量。

​	其他变量相比仅能提供较弱的影响，依此是FPARm、NDVI、LST、MMTmax、PRC、EVITa、CND、LAI和RSP。

![image-20241221213014054](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241221213014054.png)

- 环境协变量中贡献度最高的是**GPP**，它能反映单位面积和时间下植被的光合作用效率和生产力，从而体现土壤自然肥力水平。
- 其次是**LS**，它能反映出土壤受到的侵蚀强度，对于漫岗地形影响下的黑土层厚度分布特征具有较好的解释能力。
- 再是**LSTm**，它能一定程度上表征土壤质地，而土壤质地关乎土壤受外部影响导致的水土流失强度。
- 然后是**LAIm**，它能够反映植被的几何结构，高LAI通常表示更高的植被密度，从而体现植被一定的生长状况。最后是DEM，它能够反映地表在垂直方向上的相对高度变化

# 我们这个研究选择数据和因子



# 数据：

DEM、气温降水数据、遥感影像、土地利用类型、土壤类型、土壤粉砂含量

# 因子：

## 地形因子

高程、坡度、坡向、平面曲率、剖面曲率、地形起伏度、坡度坡长因子、（通道网络距离、河网基准面、相对坡度位置、地形湿度指数、谷深）

## 气候因子（可看作一样的）

年平均降雨量

年平均气温

## 遥感因子

归一化植被指数、增强植被指数、叶面积指数

## 土壤因子

土壤类型、土地利用类型、地貌类型、砂粒含量、粉粒含量
