# 基于高分七号影像自动提取东北黑土区侵蚀沟方法

## 摘要

东北沟蚀的监测大多基于目视解译，自动化程度低，需要一种快速提取办法。基于高分七号，以目视解译为参照，对比**流向边缘检测、机器学习、深度学习**3种自动提取方法的精度。

**结果：**

1. 流向边缘检测方法以来高精度地形数据，精度6.7%，自动化程度低；
2. 机器学习需要人为设置分割参数，并设计分类特征，精度50.7%；浅沟9.2%，切沟83.1%
3. 深度学习采用端对端的模式，自动化程度高，精度60.8%，浅沟69.7%，切沟68.1%

## 背景与意义

​	侵蚀沟是土地退化的表现形式之一，东北黑土区的耕地面积高达3000万hm2，是我国的第一粮仓。过度开垦导致的水土流失已经严重威胁粮食安全和生态安全。侵蚀沟调查对土壤侵蚀监测和黑土资源保护具有重要意义。

​	目前的调查主要基于遥感影像目视解译。2013年Catena期刊提出地形指数模型；2019年汤国安老师团队提出从沟谷网络中提取河岸沟方法。但是都受到地形数据本身精度的限制。2011年Geomorphology期刊发表文章提出基于对象的沟壑要素提取。2022年张琪提出面向对象分析和随机森林算法来提取黄土高原沟壑区的切沟，但这种方法依赖主观判断，耗费大量人力物力，且不同时间、地点的光谱、纹理特征差别巨大，不适合长时间大尺度区域的监测。

​	**深度学习**被提出来，学者开始使用它用来解决侵蚀沟自动提取。2018年用深度学习自动描绘青藏高原东北部的热侵蚀沟壑，证明深度学习可以提取出小且不规则的热侵蚀沟；2022年用深度学习对黄土高原浅沟进行自动提取，证明深度学习语义分割模型可以普遍应用于黄土高原。

​	**对比面向对象方法**，深度学习无需手动设计特征提取器，可以直接进行卷积运算获取卷积特征图，在逐层筛选得到深层特征。但是它**需要大量的计算资源和训练数据**。

​	目前东北黑土沟壑主要基于目视解译，2020年构建了一种机器学习算法与OBIA相结合的方法，提取东北侵蚀沟，但是是否可拓展到更大更复杂区域并未得到验证。2018年通过比较谷歌影像的浅层、中层、深层特征，分析不同层次对侵蚀沟的描述能力，发现影像中层和深层特征对侵蚀沟识别能力较强，但使用的样本量过少，难以用于对侵蚀沟的监测。

​	此文主要用于**比较**当下主流自动提取方法在东北黑土区的适用性，为东北黑土区侵蚀沟监测和防控提供参考。

## 研究区和遥感数据

1. 研究区概况

**研究区**：松嫩典型黑土区东部的黑龙江省哈尔滨市宾县宾安镇的马蛇子河流域为研究区，包含30个分布均匀的训练区（每个1平方千米），一个完整流域系统的测试区，土地利用类型主要是耕地。

![image-20250219130130816](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250219130130816.png)

2. 遥感数据选择

   ​	东北的沟普遍较小，遥感分辨率至少为0.51-1.02m，减少植被和积雪影像，最终选择高分七号2022年4月的影像，对其进行正射校正、波段融合及仿射变换，获取研究区的融合影像0.65m，和DSM数据。

## 试验设计

​	**流向边缘检测、机器学习及深度学习** ３ 种主流的自动提取方法

1. 流向边缘监测

   * 图像边缘提取

     ​	利用Laplacian算子这个二阶微分算子，计算图像梯度和曲率，获取图像的边缘和角点。求取边缘前要对图像进行高斯平滑处理，获取边缘后使用平均融合操作，确定图像分割阈值t，从而对图像进行二值化。ｔ ＝ μ ＋ ０. ５σ

   * 沟谷网络追踪检测

     ​        对DSM进行多次卷积平滑滤波，消除噪声，使地形数据与影像数据 相匹配，将地形数据重采样为0.65m，用D8算法计算流域流向，将其与图像边缘进行叠加，沿流向方向的边缘视为侵蚀沟。

2. 机器学习

   ​         面向对象技术对影像进行分割，选择合适的特征输入分类器确定阈值，随机森林具有更好的特征映射能力。本文基于PIE-SIAS图像分割技术和RF分类模型对侵蚀沟进行自动提取。

   * 图像分割

     ​	在PIE-SIAS采用图割算法对GF-7进行分割，采用光谱-纹理规则设置参数，对分割对象进行合并；并对分割对象进行标注。

   * 特征筛选

     ​	选取光谱特征、纹理特征、地形特征3类共44个特征信息，

     **光谱特征**在红绿蓝近红4个波段添加4个波段指数进行补充。

     ![image-20250219145829511](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250219145829511.png)

     ![image-20250219150039801](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250219150039801.png)

     ​	ＮＤＶＩ 为归一化植被指数；ＮＤＷＩ 为归一化水指数；ＶＤＶＩ 为可见光植被指数；ＲＧＢＶＩ 为红绿蓝植被指数，

     ​	**纹理特征**根据灰度共生矩阵分别计算 ＧＦ⁃７ 影像 ４ 个波段的均值（Ｍｅａｎ）、方差（Ｖａｒｉａｎｃｅ）、均匀度（Ｈｏｍｏｇｅｎｅｉｔｙ ）、 对 比 度 （ Ｃｏｎｔｒａｓｔ ）、 非 相 关 性（Ｄｉｓｓｉｍｉｌａｒｉｔｙ ）、 熵 （ Ｅｎｔｒｏｐｙ ）、 二 阶 矩 （ ＳｅｃｏｎｄＭｏｍｅｎｔ）、相关性（Ｃｏｒｒｅｌａｔｉｏｎ），地形特征（ＤＳＭ）根据 ＡｒｃＧＩＳ 地形分析获取坡度（ Ｓｌｏｐｅ）、山体阴影（Ｈｉｌｌ Ｓｈａｄｅ）、坡面曲率（ ＳｏＳ）。

     ​	采用 SKlearn-Python 对 44个特征进行**重要性评估**，选择重要性排名靠前的特征输入 RF分类模型进行训练。

3. 深度学习

   ​	像素标记-卷积和池化操作提取深层特征-对像素进行拟合-反向传播算法进行梯度下降，直至网络收敛，特征权重保存到网络模型中，最终实现对图像的分割。

   * 样本标注

     ​	建立侵蚀沟解译标志是后续侵蚀沟样本标注的基础。ＡｒｃＧＩＳ 在 １ ∶ ３０００ ～ １ ∶ １２５０ 的比例尺下对流域内３０ 个训练区进行样本标注，对侵蚀沟赋值为 １，背景值赋值为 ０。进行裁剪处理，数据进行筛选，去除全部是背景的图像，最终获得 ８２５７ 张训练影像，对其按照７：３划分为训练集和验证集数据。

   * 模型选择

     ​	HRNet 采用并行结构，同时处理高分辨率和低分辨率特征图谱，通过两者交互获取高空间精度的深层特征。

   * 模型训练

     ​	基于 Ｔｒｏｃｈ⁃ＧＰＵ 框架搭建 ＨＲＮｅｔ，采用交叉熵损失函数进行模型收敛，并使用 ｈｒｎｅｔｖ２ ＿ ｗ１８ ＿ｉｍａｇｅｎｅｔ＿ｐｒｅｔｒａｉｎｅｄ． ｐｔｈ 预训练权重加快训练速度。

4. 数据后处理

​	3种均存在过提取现象

​	流向边缘检测方法误提取区域与侵蚀沟存在连接现象，无法进行后处理

​	机器学习方法误提取区域主要为一些田垄和欠分割区域，面积和侵蚀沟无法进行区分。 本文采用**宽窄度指数**对其剔除，公式为

![image-20250219153355753](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250219153355753.png)

**深度学习方法**误提取区域主要为阴影区域，面积与侵蚀沟相差较大。 对训练样本统计分析发现，大部分侵蚀沟面积大于２３０ ｍ２，因此对面积小于 ２３０ ｍ２ 的区域进行剔除。

5. 自动提取精度验证

基于**混淆矩阵**从不同方面选取 ４ 个指标，分别为 Ｐ （ Precision）、Ｒ （ Recall）、Ｆ１ （ F1-score）、 ＩｏＵ（intersection over union）对自动提取结果进行精度评估，计算公式分别为

![image-20250219153805008](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250219153805008.png)

![image-20250219153819634](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250219153819634.png)

此外通过对比1km*1km单元上的侵蚀沟线密度和面密度来评估提取结果的适用性。

## 结果与分析

![image-20250219155022382](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250219155022382.png)

![image-20250219155042898](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250219155042898.png)

![image-20250219155053249](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250219155053249.png)

![image-20250219155106137](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250219155106137.png)

![image-20250219155212434](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250219155212434.png)

<img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250219160622821.png" alt="image-20250219160622821" style="zoom:150%;" />

## 结论

